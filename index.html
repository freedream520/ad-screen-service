<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Ad Screen Service by com-localad</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Ad Screen Service</h1>
        <p>互联网广告屏的后端服务</p>

        <p class="view"><a href="https://github.com/com-localad/ad-screen-service">View the Project on GitHub <small>com-localad/ad-screen-service</small></a></p>


        <ul>
          <li><a href="https://github.com/com-localad/ad-screen-service/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/com-localad/ad-screen-service/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/com-localad/ad-screen-service">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="%E4%BA%92%E8%81%94%E7%BD%91%E5%B9%BF%E5%91%8A%E5%B1%8F%E7%9A%84%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1" class="anchor" href="#%E4%BA%92%E8%81%94%E7%BD%91%E5%B9%BF%E5%91%8A%E5%B1%8F%E7%9A%84%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1"><span class="octicon octicon-link"></span></a>互联网广告屏的后端服务</h1>

<h2>
<a name="%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96" class="anchor" href="#%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96"><span class="octicon octicon-link"></span></a>环境依赖</h2>

<ul>
<li>mongoDB服务需开启，最好设置为开机启动。</li>
</ul>

<p>环境依赖的部署安装，参考：<a href="http://www.localad.org.cn/requisites.html">http://www.localad.org.cn/requisites.html</a></p>

<h2>
<a name="%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" class="anchor" href="#%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="octicon octicon-link"></span></a>部署服务的目录结构</h2>

<p>部署服务需要的目录结构如下：</p>

<ul>
<li>
<strong>config：</strong>服务的配置目录</li>
<li>
<strong>ad-screen：</strong>服务的软链接目录。</li>
<li>
<strong>data：</strong>服务的数据存储目录。

<ul>
<li>**mongodb：**MongoDB的目录。

<ul>
<li>
<strong>data：</strong>数据库目录。</li>
<li>
<strong>log：</strong>日志目录。</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>static：</strong>用于存储上传的广告物料等静态资源。</li>
<li>
<strong>tmp：</strong>上传文件时，用于临时存储。</li>
<li>
<strong>release：</strong>版本发布目录。</li>
</ul>

<p><strong>建议：</strong>可以部署在目标服务器的<code>/home/localad/ad-screen-service</code>目录下。</p>

<h2>
<a name="%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%9A%84%E6%96%B9%E6%B3%95" class="anchor" href="#%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2%E7%9A%84%E6%96%B9%E6%B3%95"><span class="octicon octicon-link"></span></a>服务部署的方法</h2>

<h3>
<a name="%E5%85%8B%E9%9A%86%E5%92%8C%E9%83%A8%E7%BD%B2" class="anchor" href="#%E5%85%8B%E9%9A%86%E5%92%8C%E9%83%A8%E7%BD%B2"><span class="octicon octicon-link"></span></a>克隆和部署</h3>

<p>使用GIT克隆项目代码：</p>

<pre><code>cd /home/localad/ad-screen-service/release
git clone https://github.com/com-localad/ad-screen-service.git ad-screen-service-{版本号} -b {版本号}
</code></pre>

<h3>
<a name="%E5%BB%BA%E7%AB%8B%E8%BD%AF%E8%BF%9E%E6%8E%A5" class="anchor" href="#%E5%BB%BA%E7%AB%8B%E8%BD%AF%E8%BF%9E%E6%8E%A5"><span class="octicon octicon-link"></span></a>建立软连接</h3>

<pre><code>rm -rf /home/localad/ad-screen-service/ad-screen
ln -s /home/localad/ad-screen-service/release/ad-screen-service-{版本号} /home/localad/ad-screen-service/ad-screen
</code></pre>

<h3>
<a name="%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F" class="anchor" href="#%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F"><span class="octicon octicon-link"></span></a>配置系统</h3>

<p>第一次部署时，需要复制系统配置文件，并设置：</p>

<pre><code>cp -r /home/localad/ad-screen-service/release/ad-screen-service-{版本号}/dist/config /home/localad/ad-screen-service
</code></pre>

<p>可以使用如下命令，复制mongoDB的存储目录结构：</p>

<pre><code>cp -r /home/localad/ad-screen-service/release/ad-screen-service-{版本号}/dist/data /home/localad/ad-screen-service
</code></pre>

<h2>
<a name="%E5%90%AF%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1" class="anchor" href="#%E5%90%AF%E5%8A%A8%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1"><span class="octicon octicon-link"></span></a>启动系统服务</h2>

<h3>
<a name="windows%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83" class="anchor" href="#windows%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83"><span class="octicon octicon-link"></span></a>Windows测试环境</h3>

<p>进入<code>dist/ad-screen/bin</code>目录，使用<code>shift+右键</code>，在当前目录打开命令窗口。</p>

<p>执行命令<code>node-server.cmd</code>，启动桩的Web服务（安装NPM包，扫瞄服务模块，启用端口，启用域名）。</p>

<h3>
<a name="linux%E4%BA%A7%E5%93%81%E7%8E%AF%E5%A2%83" class="anchor" href="#linux%E4%BA%A7%E5%93%81%E7%8E%AF%E5%A2%83"><span class="octicon octicon-link"></span></a>Linux产品环境</h3>

<p>进入<code>ad-screen/bin</code>目录，可以使用以下命令：</p>

<ol>
<li>
<code>sh server-install.sh</code>：安装服务框架NPM包，扫瞄服务模块，安装服务模块依赖的NPM包。</li>
<li>
<code>sh node-server.sh start</code>：启动产品环境的Web服务（启用端口，启用域名）。</li>
<li>
<code>sh node-server.sh stop</code>：停止产品环境的Web服务。</li>
<li>
<code>sh node-server.sh restart</code>：重启产品环境的Web服务。</li>
</ol>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/com-localad">com-localad</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>